{"ast":null,"code":"var _jsxFileName = \"C:\\\\wamp64\\\\www\\\\Reto-4\\\\src\\\\pages\\\\carrito\\\\carrito.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect } from 'react';\nimport './carrito.css';\nimport Title from \"./componentes/title\";\nimport Modal from \"./componentes/modal\";\nimport Info from \"./componentes/info\";\nimport $ from \"jquery\";\nimport emailjs from 'emailjs-com';\nimport Swal from 'sweetalert2';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Carrito() {\n  _s();\n\n  useEffect(() => {\n    const cart = JSON.parse(localStorage.getItem(\"cart\"));\n    setTotalPlatesCart(cart);\n\n    if (!cart) {\n      localStorage.setItem(\"cart\", JSON.stringify([]));\n    } else {\n      let html = \"\";\n      getTotalPrice(cart);\n      cart.forEach(plate => {\n        html = `<div class=\"row mb-5\" id=\"${plate.plateId}\">\n      <div class=\"col-3\"><img src=\"${plate.plateImage}\" alt=\"\" class=\"w-100\"></div>\n      <div class=\"col-9\">\n        <div class=\"row align-items-end\">\n          <div class=\"col-auto\">\n            <h3 class=\"m-0 pedido-plate font-weight-bold value text-left\">${plate.plateTitle}</h3>\n          </div>\n          <div class=\"col-auto\">\n            <h4 class=\"m-0 value font-weight-bold\">${\"$\" + plate.platePrice.toLocaleString()}</h4>\n          </div>\n          <div class=\"col-auto\">\n            <button class=\"mr-3\"><i class=\" fas fa-trash \" style=\"font-size: 1.5rem;\">Eliminar</i></button>\n          </div>\n        </div>\n        <div class=\"row mt-3\">\n          <div class=\"col-8\">\n            <p>${plate.plateDescription}</p>\n          </div>\n        </div>\n        <div class=\"row\">\n          <div class=\"col-auto\">\n            <button class=\"btn font-weight-bold btn-cal\" type=\"button\">-</button>\n            <input disabled class=\"pedido-input text-center\" id=\"quantity1\" type=\"number\" inputmode=\"numeric\" value=\"${plate.plateAmount}\">\n            <button class=\"btn font-weight-bold btn-cal\" type=\"button\">+</button>\n          </div>\n        </div>\n      </div>\n    </div>` + html;\n      });\n      html += `<div class=\"row mt-3 justify-content-center\">\n    <div class=\"col-auto\">\n      <a href=\"./menu\" class=\"btn pedido-btn-add font-weight-bold\">CONTINUAR COMPRANDO</a>\n    </div>\n  </div>`;\n      $(\"#plates .row .col-8\").html(html);\n      $(\"#total\").text(\"$\" + getTotalPrice(cart).toLocaleString());\n      $(\"button.btn-cal\").on(\"click\", function (event) {\n        let button = $(this);\n        let operator = button.text();\n        setAmount(button, operator, cart);\n      });\n      $(\".fas.fa-trash\").parent().on(\"click\", function (event) {\n        let cartElement = $(this).closest(\"div[id]\").remove();\n        let plateId = parseInt(cartElement.attr(\"id\"));\n        let indexToDelete = cart.findIndex(plate => plate.plateId === plateId);\n        let total = getTotalPrice(cart);\n        total -= cart[indexToDelete].plateAmount * cart[indexToDelete].platePrice;\n        console.log(total);\n        cart.splice(indexToDelete, 1);\n        localStorage.setItem(\"cart\", JSON.stringify(cart));\n        setTotalPlatesCart(cart);\n        $(\"#total\").text(\"$\" + total.toLocaleString());\n\n        if (cart.length === 0) {\n          $(\"#btnReservar\").off();\n        }\n      });\n\n      if (cart.length > 0) {\n        $(\"#btnReservar\").on(\"click\", function () {\n          $(\"#modalReserva\").modal();\n          $(\"#modalReserva\").show();\n          const modal = $(this);\n          const formReservation = $(\"#formReserva\");\n          formReservation.on(\"submit\", function (event) {\n            event.preventDefault();\n            let formData = new FormData($(this)[0]);\n            let header = `\n          <!DOCTYPE html>\n  <html>\n  <head>\n  <style>\n  table {\n    font-family: arial, sans-serif;\n    border-collapse: collapse;\n    width: 100%;\n  }\n  \n  td, th {\n    border: 1px solid #dddddd;\n    text-align: center;\n    padding: 8px;\n  }\n  \n  </style>\n  </head>\n  <body>\n          <table>\n          <tr>\n              <th>Plato</th>\n              <th>Imagen</th>\n              <th>Precio</th>\n              <th>Cantidad</th>\n              <th>Total</th>\n          </tr>`;\n            let footer = `<tr>\n          <td></td>\n          <td></td>\n          <td></td>\n          <td></td>\n          <td>$${getTotalPrice(cart).toLocaleString()}</td>\n      </tr>\n  </table>\n  </body>\n  </html>`;\n            cart.forEach(plate => {\n              header += `<tr>\n            <td>${plate.plateTitle}</td>\n            <td><img src=\"jhonierk.github.io/Restaurant/${plate.plateImage.replace(\".\", \"\").replace(\".\", \"\").replace(\"/\", \"\")}\" alt=\"\" style=\"width: 100px;height: 100px;\"></td>\n            <td>$${plate.platePrice.toLocaleString()}</td>\n            <td>${plate.plateAmount}</td>\n            <td>$${(plate.plateAmount * plate.platePrice).toLocaleString()}</td>\n        </tr>`;\n            });\n            let data = {\n              email: formData.get(\"email\"),\n              name: formData.get(\"name\"),\n              html: header + footer\n            };\n            emailjs.init(\"user_5EBnjcadQYKcG9dJU2dJ6\");\n            emailjs.send(\"gmail\", \"reserva-menu\", data).then(function (response) {\n              if (response.text === \"OK\") {\n                localStorage.setItem(\"cart\", JSON.stringify([]));\n                $(\"#modalReserva\").modal(\"hide\");\n                setTotalPlatesCart([]);\n                $(\"#total\").text(\"$0\");\n                $(\"#btnReservar\").off();\n                $(\"#plates .row .col-8\").html(`<div class=\"row py-5\">\n                <div class=\"col-auto\">\n                  <h2>No hay nada en el carrito</h2>\n                </div>\n              </div>\n              <div class=\"row py-5 justify-content-center\">\n                <div class=\"col-auto\">\n                  <a href=\"./Pedido.html\" class=\"btn pedido-btn-add font-weight-bold\">CONTINUAR COMPRANDO</a>\n                </div>\n              </div>`);\n                Swal.fire({\n                  icon: \"success\",\n                  title: \"El correo se ha enviado de forma exitosa\",\n                  text: \"Revise su bandeja de entrada\",\n                  showConfirmButton: false,\n                  timer: 3000\n                });\n              }\n\n              formReservation[0].reset();\n              console.log(\"SUCCESS. status=%d, text=%s\", response.status, response.text);\n            }\n            /* function (err) {\r\n              footer;\r\n              Swal.fire({\r\n                icon: \"error\",\r\n                title: \"Oops...\",\r\n                text: \"Ocurrió un problema al enviar el correo\",\r\n              });\r\n              console.log(\"FAILED. error=\", err);\r\n            } */\n            );\n          });\n          modal.on(\"hidden.bs.modal\", function (event) {\n            formReservation[0].reset();\n            formReservation.off(\"submit\");\n          });\n        });\n      }\n    }\n\n    function setAmount(button, operator) {\n      let inputAmount;\n      let amount;\n      let plateId = parseInt(button.closest(\"div[id]\").attr(\"id\"));\n      let plateCartIndex = cart.findIndex(plate => plate.plateId === plateId);\n      let total = getTotalPrice(cart);\n\n      switch (operator) {\n        case \"-\":\n          inputAmount = button.next();\n\n          if (parseInt(inputAmount.val()) - 1 < 1) {\n            amount = 1;\n          } else {\n            amount = parseInt(inputAmount.val()) - 1;\n            total -= cart[plateCartIndex].platePrice;\n          }\n\n          break;\n\n        case \"+\":\n          total += cart[plateCartIndex].platePrice;\n          inputAmount = button.prev();\n          amount = parseInt(inputAmount.val()) + 1;\n          break;\n\n        default:\n          alert(\"Error\");\n          break;\n      }\n\n      cart[plateCartIndex].plateAmount = amount;\n      localStorage.setItem(\"cart\", JSON.stringify(cart));\n      setTotalPlatesCart(cart);\n      inputAmount.val(amount);\n      $(\"#total\").text(\"$\" + total.toLocaleString());\n    }\n\n    function setTotalPlatesCart(cart) {\n      let totalPlatesCart = 0;\n      cart.forEach(plate => {\n        totalPlatesCart += plate.plateAmount;\n      });\n      $(\"#lblCartCount\").text(totalPlatesCart);\n    }\n\n    function getTotalPrice(cart) {\n      return cart.length > 0 ? cart.map(plate => plate.plateAmount * plate.platePrice).reduce((total, i) => total + i) : 0;\n    }\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Title, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Info, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 274,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 271,\n    columnNumber: 7\n  }, this);\n}\n\n_s(Carrito, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n\n_c = Carrito;\n\nvar _c;\n\n$RefreshReg$(_c, \"Carrito\");","map":{"version":3,"sources":["C:/wamp64/www/Reto-4/src/pages/carrito/carrito.jsx"],"names":["React","useEffect","Title","Modal","Info","$","emailjs","Swal","Carrito","cart","JSON","parse","localStorage","getItem","setTotalPlatesCart","setItem","stringify","html","getTotalPrice","forEach","plate","plateId","plateImage","plateTitle","platePrice","toLocaleString","plateDescription","plateAmount","text","on","event","button","operator","setAmount","parent","cartElement","closest","remove","parseInt","attr","indexToDelete","findIndex","total","console","log","splice","length","off","modal","show","formReservation","preventDefault","formData","FormData","header","footer","replace","data","email","get","name","init","send","then","response","fire","icon","title","showConfirmButton","timer","reset","status","inputAmount","amount","plateCartIndex","next","val","prev","alert","totalPlatesCart","map","reduce","i"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\r\nimport './carrito.css';\r\nimport Title from \"./componentes/title\";\r\nimport Modal from \"./componentes/modal\";\r\nimport Info from \"./componentes/info\";\r\nimport $ from \"jquery\"\r\nimport emailjs from 'emailjs-com';\r\nimport Swal from 'sweetalert2';\r\n\r\nexport default function Carrito(){\r\n\r\n  useEffect(() => {\r\n  const cart = JSON.parse(localStorage.getItem(\"cart\"));\r\n  setTotalPlatesCart(cart);\r\n  if (!cart) {\r\n    localStorage.setItem(\"cart\", JSON.stringify([]));\r\n  } else {\r\n    let html = \"\";\r\n    getTotalPrice(cart);\r\n    cart.forEach((plate) => {\r\n      html =\r\n        `<div class=\"row mb-5\" id=\"${plate.plateId}\">\r\n      <div class=\"col-3\"><img src=\"${\r\n        plate.plateImage\r\n      }\" alt=\"\" class=\"w-100\"></div>\r\n      <div class=\"col-9\">\r\n        <div class=\"row align-items-end\">\r\n          <div class=\"col-auto\">\r\n            <h3 class=\"m-0 pedido-plate font-weight-bold value text-left\">${\r\n              plate.plateTitle\r\n            }</h3>\r\n          </div>\r\n          <div class=\"col-auto\">\r\n            <h4 class=\"m-0 value font-weight-bold\">${\r\n              \"$\" + plate.platePrice.toLocaleString()\r\n            }</h4>\r\n          </div>\r\n          <div class=\"col-auto\">\r\n            <button class=\"mr-3\"><i class=\" fas fa-trash \" style=\"font-size: 1.5rem;\">Eliminar</i></button>\r\n          </div>\r\n        </div>\r\n        <div class=\"row mt-3\">\r\n          <div class=\"col-8\">\r\n            <p>${plate.plateDescription}</p>\r\n          </div>\r\n        </div>\r\n        <div class=\"row\">\r\n          <div class=\"col-auto\">\r\n            <button class=\"btn font-weight-bold btn-cal\" type=\"button\">-</button>\r\n            <input disabled class=\"pedido-input text-center\" id=\"quantity1\" type=\"number\" inputmode=\"numeric\" value=\"${\r\n              plate.plateAmount\r\n            }\">\r\n            <button class=\"btn font-weight-bold btn-cal\" type=\"button\">+</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>` + html;\r\n    });\r\n    html += `<div class=\"row mt-3 justify-content-center\">\r\n    <div class=\"col-auto\">\r\n      <a href=\"./menu\" class=\"btn pedido-btn-add font-weight-bold\">CONTINUAR COMPRANDO</a>\r\n    </div>\r\n  </div>`;\r\n    $(\"#plates .row .col-8\").html(html);\r\n    $(\"#total\").text(\"$\" + getTotalPrice(cart).toLocaleString());\r\n  \r\n    $(\"button.btn-cal\").on(\"click\", function (event) {\r\n      let button = $(this);\r\n      let operator = button.text();\r\n      setAmount(button, operator, cart);\r\n    });\r\n  \r\n    $(\".fas.fa-trash\")\r\n      .parent()\r\n      .on(\"click\", function (event) {\r\n        let cartElement = $(this).closest(\"div[id]\").remove();\r\n        let plateId = parseInt(cartElement.attr(\"id\"));\r\n        let indexToDelete = cart.findIndex((plate) => plate.plateId === plateId);\r\n        let total = getTotalPrice(cart);\r\n\r\n        total -= cart[indexToDelete].plateAmount * cart[indexToDelete].platePrice;\r\n                console.log(total)\r\n        cart.splice(indexToDelete, 1);\r\n        localStorage.setItem(\"cart\", JSON.stringify(cart));\r\n        setTotalPlatesCart(cart);\r\n        $(\"#total\").text(\"$\" + total.toLocaleString());\r\n  \r\n        if (cart.length === 0) {\r\n          $(\"#btnReservar\").off();\r\n        }\r\n      });\r\n  \r\n    if (cart.length > 0) {\r\n      $(\"#btnReservar\").on(\"click\", function () {\r\n        $(\"#modalReserva\").modal();\r\n        $(\"#modalReserva\").show();\r\n  \r\n        const modal = $(this);\r\n        const formReservation = $(\"#formReserva\");\r\n  \r\n        formReservation.on(\"submit\", function (event) {\r\n          event.preventDefault();\r\n          let formData = new FormData($(this)[0]);\r\n          let header = `\r\n          <!DOCTYPE html>\r\n  <html>\r\n  <head>\r\n  <style>\r\n  table {\r\n    font-family: arial, sans-serif;\r\n    border-collapse: collapse;\r\n    width: 100%;\r\n  }\r\n  \r\n  td, th {\r\n    border: 1px solid #dddddd;\r\n    text-align: center;\r\n    padding: 8px;\r\n  }\r\n  \r\n  </style>\r\n  </head>\r\n  <body>\r\n          <table>\r\n          <tr>\r\n              <th>Plato</th>\r\n              <th>Imagen</th>\r\n              <th>Precio</th>\r\n              <th>Cantidad</th>\r\n              <th>Total</th>\r\n          </tr>`;\r\n          let footer = `<tr>\r\n          <td></td>\r\n          <td></td>\r\n          <td></td>\r\n          <td></td>\r\n          <td>$${getTotalPrice(cart).toLocaleString()}</td>\r\n      </tr>\r\n  </table>\r\n  </body>\r\n  </html>`;\r\n  \r\n          cart.forEach((plate) => {\r\n            header += `<tr>\r\n            <td>${plate.plateTitle}</td>\r\n            <td><img src=\"jhonierk.github.io/Restaurant/${plate.plateImage\r\n              .replace(\".\", \"\")\r\n              .replace(\".\", \"\")\r\n              .replace(\"/\", \"\")}\" alt=\"\" style=\"width: 100px;height: 100px;\"></td>\r\n            <td>$${plate.platePrice.toLocaleString()}</td>\r\n            <td>${plate.plateAmount}</td>\r\n            <td>$${(plate.plateAmount * plate.platePrice).toLocaleString()}</td>\r\n        </tr>`;\r\n          });\r\n  \r\n          let data = {\r\n            email: formData.get(\"email\"),\r\n            name: formData.get(\"name\"),\r\n            html: header + footer,\r\n          };\r\n  \r\n          emailjs.init(\"user_5EBnjcadQYKcG9dJU2dJ6\");\r\n  \r\n          emailjs.send(\"gmail\", \"reserva-menu\", data).then(\r\n            function (response) {\r\n              if (response.text === \"OK\") {\r\n                localStorage.setItem(\"cart\", JSON.stringify([]));\r\n                $(\"#modalReserva\").modal(\"hide\");\r\n                setTotalPlatesCart([]);\r\n                $(\"#total\").text(\"$0\");\r\n                $(\"#btnReservar\").off();\r\n                $(\"#plates .row .col-8\").html(`<div class=\"row py-5\">\r\n                <div class=\"col-auto\">\r\n                  <h2>No hay nada en el carrito</h2>\r\n                </div>\r\n              </div>\r\n              <div class=\"row py-5 justify-content-center\">\r\n                <div class=\"col-auto\">\r\n                  <a href=\"./Pedido.html\" class=\"btn pedido-btn-add font-weight-bold\">CONTINUAR COMPRANDO</a>\r\n                </div>\r\n              </div>`);\r\n                Swal.fire({\r\n                  icon: \"success\",\r\n                  title: \"El correo se ha enviado de forma exitosa\",\r\n                  text: \"Revise su bandeja de entrada\",\r\n                  showConfirmButton: false,\r\n                  timer: 3000,\r\n                });\r\n              }\r\n              formReservation[0].reset();\r\n              console.log(\r\n                \"SUCCESS. status=%d, text=%s\",\r\n                response.status,\r\n                response.text\r\n              );\r\n            },\r\n            /* function (err) {\r\n              footer;\r\n              Swal.fire({\r\n                icon: \"error\",\r\n                title: \"Oops...\",\r\n                text: \"Ocurrió un problema al enviar el correo\",\r\n              });\r\n              console.log(\"FAILED. error=\", err);\r\n            } */\r\n          );\r\n        });\r\n  \r\n        modal.on(\"hidden.bs.modal\", function (event) {\r\n          formReservation[0].reset();\r\n          formReservation.off(\"submit\");\r\n        });\r\n      });\r\n    }\r\n  }\r\n  \r\n  function setAmount(button, operator) {\r\n    let inputAmount;\r\n    let amount;\r\n    let plateId = parseInt(button.closest(\"div[id]\").attr(\"id\"));\r\n    let plateCartIndex = cart.findIndex((plate) => plate.plateId === plateId);\r\n    let total = getTotalPrice(cart);\r\n  \r\n    switch (operator) {\r\n      case \"-\":\r\n        inputAmount = button.next();\r\n  \r\n        if (parseInt(inputAmount.val()) - 1 < 1) {\r\n          amount = 1;\r\n        } else {\r\n          amount = parseInt(inputAmount.val()) - 1;\r\n          total -= cart[plateCartIndex].platePrice;\r\n        }\r\n  \r\n        break;\r\n      case \"+\":\r\n        total += cart[plateCartIndex].platePrice;\r\n        inputAmount = button.prev();\r\n        amount = parseInt(inputAmount.val()) + 1;\r\n        break;\r\n      default:\r\n        alert(\"Error\");\r\n        break;\r\n    }\r\n  \r\n    cart[plateCartIndex].plateAmount = amount;\r\n    localStorage.setItem(\"cart\", JSON.stringify(cart));\r\n    setTotalPlatesCart(cart);\r\n    inputAmount.val(amount);\r\n    $(\"#total\").text(\"$\" + total.toLocaleString());\r\n  }\r\n  \r\n  function setTotalPlatesCart(cart) {\r\n    let totalPlatesCart = 0;\r\n    cart.forEach((plate) => {\r\n      totalPlatesCart += plate.plateAmount;\r\n    });\r\n    $(\"#lblCartCount\").text(totalPlatesCart);\r\n  }\r\n  \r\n  function getTotalPrice(cart) {\r\n    return cart.length > 0\r\n      ? cart\r\n          .map((plate) => plate.plateAmount * plate.platePrice)\r\n          .reduce((total, i) => total + i)\r\n      : 0;\r\n  }\r\n});\r\n\r\n    return(\r\n      <div>\r\n        <Title />\r\n        <Modal />\r\n        <Info />\r\n      </div>  \r\n    )\r\n}"]},"metadata":{},"sourceType":"module"}